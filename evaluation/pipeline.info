Matcher {
  maxTraceLength 10
  matchInImageSpace false
  initialLandmarkId 0
  
  DenseMatcher {
    nThreads 8
    nBest 4
    useDistanceRatioThreshold false 
  }

  DescriptorTrackingAlgorithm {
    distanceThreshold 60
    disparityThreshold 1e12
  }
}

UndistortingPipeline {
  nThreads 1
  doBackProjection true
  doBackProjectionUncertainty false
  cameraSystemName /brisk_evaluation  ; The full path of the camera system in the config file
  timestampTolerance 0.01 ; The tolerance for accepting images as being seen at the same time (seconds)
  doTimestampCorrection false
  framerate 10.0 ; [hz]

  undistorter0 {
     ; This undistorts images using the interpolation method below. Choose 'NullMaskedDistortedOmniCameraGeometry' to disable undistortion.
     type OmniUndistorter
     ; alpha: The free scaling parameter between 0 (when all the pixels in the undistorted image will be valid) and 1 (when all the source image pixels will be retained in the undistorted image
     alpha 0.0
     ; interpolation: INTER_NEAREST(0), INTER_LINEAR(1), INTER_CUBIC(2), INTER_LANCZOS4(4)
     interpolationType 4
     ; scale the image?
     scale 1.0
     makeCopy true
  }
 
  frameBuilder0 {
    type brisk
    brisk
    {
        octaves 2
        uniformityRadius 30
        absoluteThreshold 200
        maxNoKeypoints 10000
        rotationInvariant true
        scaleInvariant true
        cameraModel RadialTangentialPinhole
        intrinsics /brisk_evaluation/intrinsics0
    }
  }
}

brisk_evaluation {
  nCameras 1
  vehicle-name brisk_evaluator
  compute-overlaps  0
  intrinsics0 {
    type MaskedDistortedOmni
    shutter {
      line-delay 0.0001
    }

    ; The front camera intrinsics
    projection {
      xi  1.18831474
      fu  914.67941641
      fv  913.88541643
      cu  632.58146506
      cv  462.74954198
      ru  1280
      rv  960
      distortion {
	   k1 -0.36818943
	   k2 0.15409458
	   p1 -0.0004963
	   p2 -0.00057473
      }
    }
    mask {
      mask-file  none
    }
  }
  extrinsics0 {
    ; The front camera extrinsics
    T_v_c {
      q_a_b {
	      x 0.50618922
	      y -0.48694621
	      z 0.50031233
	      w 0.50630369
      }
      t_a_b_a {
	      x 0.04200892
	      y 0.00606903
	      z -0.01774598
      }
    }
  }
}
